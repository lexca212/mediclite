<div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
        Tutup</button>
    <h4 class="modal-title">Permintaan Ranap</h4>
</div>
<div class="modal-body">
    <div class="row">
        <div class="col-md-6">
            <div class="form-group">
                <label>Nomor Rawat</label>
                <input type="text" name="no_rawat_permintaanRanap" class="form-control" placeholder="Nomor Rawat" required
                    value="{$reg_periksa.no_rawat}" readonly />
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label>Nama Pasien</label>
                <input type="text" name="nm_pasien" class="form-control" placeholder="Pasien" required
                    value="{$pasien.nm_pasien}" readonly />
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label>Nomor Rekam Medis</label>
                <input type="text" name="no_rkm_medis" class="form-control" placeholder="rekam_medis" required
                    value="{$pasien.no_rkm_medis}" readonly />
            </div>
        </div>
        <div class="col-sm-3">
            <div class="form-group">
                <label for="kd_dokter">Dokter</label>
                <input type="text" name="kd_dokter" class="form-control" required value="{$dokter.nm_dokter}" readonly>
            </div>
        </div>
        <div class="col-sm-3">
            <div class="form-group">
                <label for="tanggal">Tanggal</label>
                <input type="text" name="tanggal" id="tanggal" class="form-control" placeholder=""
                    value="{?=date('Y-m-d')?}" readonly>
            </div>
        </div>
        <!--<div class="col-sm-3">
            <div class="form-group">
                <label for="diagnosa">Diagnosa</label>
                <input type="text" name="diagnosa" id="diagnosa" class="form-control" value="{if: $permintaan_ranap}{?=isset_or($permintaan_ranap.diagnosa,'')?}{else}{?=isset_or($data_hasilusg.hasil_pemeriksaan_usg.diagnosa,'')?}{/if}">
            </div>
        </div>-->
         <div class="col-sm-3">
            <div class="form-group">
                <label for="diagnosa">Diagnosa</label>
                
                <!--<option value="{$value.nm_penyakit}">{$value.nm_penyakit}</option>-->
                <input type="text" name="diagnosa" id="diagnosa" class="form-control" value="{if: $permintaan_ranap}{?=isset_or($permintaan_ranap.diagnosa,'')?}{else}{?=isset_or($permintaan_ranap.permintaan_ranap.diagnosa,'')?}{/if}">
            </div>
        </div>
        <div class="col-sm-3">
            <div class="form-group">
                <label for="catatan">Indikasi Ranap / DPJP</label>
                <input type="text" name="catatan" id="catatan" class="form-control" value="{if: $permintaan_ranap}{?=isset_or($permintaan_ranap.catatan,'')?}{else}{?=isset_or($permintaan_ranap.permintaan_ranap.catatan,'')?}{/if}">
            </div>
        </div>
            <!--<div class="col-sm-12">
                <div class="form-group">
                    <label for="catatan">Kamar</label>
                    <select class="form-control" name="kd_kamar">
                         {loop: $rawat_inap.kamar}
                         <option value="{$value.kd_kamar}"{if: $rawat_inap.kamar_inap.kd_kamar == $value.kd_kamar} selected{/if}>{$value.nm_bangsal} - {$value.kd_kamar}</option>
                        {/loop}
                    </select>
                </div>
            </div>-->
            <div class="col-sm-5">
                <div class="form-group">
                    <label for="catatan">Kamar</label>
                    <select class="form-control" name="kd_kamar">
                         {loop: $rawat_inap.kamar}
                         <option value="{$value.kd_kamar}">{$value.nm_bangsal} - {$value.kd_kamar}</option>
                        {/loop}
                    </select>
                </div>
            </div>
            <div class="col-md-12">
                <button class="btn btn-success" id="savePermintaan">Simpan</button>
                <!--<button class="btn btn-primary" id="printPDF">Cetak PDF</button>-->
                <button type="button" class="btn btn-danger" data-dismiss="modal">Kembali</button>
            </div>
        </div>
    </div>
</div>
<br>
    <div class="tampildata">
      <table class="table" width="100%">
        <thead>
          <tr>
            <th>Nomor Rawat</th>
            <th>Diagnosa</th>
            <th>Kamar</th>
            <th>Indikasi</th>
          </tr>
        </thead>
        <tbody>
      {if: $permintaan_ranap}
      <tr>
        <td>{$permintaan_ranap.no_rawat}</td>
        <td>{$permintaan_ranap.diagnosa}</td>
        <td>{$permintaan_ranap.kd_kamar}</td>
        <td>{$permintaan_ranap.catatan}</td>
      </tr>
      {else}
      <tr>
        <td colspan="5">Tidak ada data</td>
      </tr>
      {/if}
    </tbody>
      </table>
    </div>
</div>
<script type="text/javascript">
$('select').selectator();
$(document).ready(function(){
  $("#savePermintaan").click(function(){
    var baseURL = mlite.url + '/' + mlite.admin;
    var no_rawat = $('input:text[name=no_rawat_permintaanRanap]').val();
    var set_no_rawat = $('input:text[name=no_rawat_permintaanRanap]').val().replace(/\//g, '');
    //var kd_dokter = $('#kd_dokter').val();
    var tanggal = $('#tanggal').val();
    var diagnosa = $('#diagnosa').val();
    var catatan = $('#catatan').val();
    var kd_kamar = $('select[name=kd_kamar]').val();
    

    var url = baseURL + '/dokter_igd/permintaanranap/?t=' + mlite.token;
    $.post(url,{
      no_rawat:no_rawat,
      //kd_dokter:kd_dokter,
      tanggal:tanggal,
      diagnosa:diagnosa,
      catatan:catatan,
      kd_kamar:kd_kamar
    } ,function(data) {
      console.log(data);
      $('.tampildata').load(baseURL + '/dokter_igd/permintaanranaptampil/' + set_no_rawat + '?t=' + mlite.token);
    });
  });
});
</script>